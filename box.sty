%% 박스, 틀, 테두리 등 시각적 요소 정의

%% 박스 스타일 정의

% 회색 박스 (설명, 정리 등) - 패키지 불러와야 newtcolorbox 쓸 수 있음
\newtcolorbox{graybox}{%
  colback=white,        % 흰색 배경
  colframe=gray!50,     % 중간 회색 테두리
  boxrule=1pt,          % 테두리 선 두께
  arc=2mm,              % 둥근 모서리 반경
  left=4pt, right=4pt,  % 좌우 여백
  top=4pt, bottom=4pt   % 상하 여백
}

% 회색 수식 박스 - graybox에 수식 정렬만 추가
\newtcolorbox{eqbox}[1][]{%
  ams align,            % 수식 정렬
  colback=gray!10,      % 연한 회색 배경
  colframe=gray!50,     % 중간 회색 테두리
  boxrule=1pt,          % 테두리 선 두께
  arc=2mm,              % 둥근 모서리 반경
  left=4pt, right=4pt,  % 좌우 여백
  top=4pt, bottom=4pt   % 상하 여백
}

% 강조용 빨간 테두리 박스
\newtcolorbox{redbox}{%
  colback=white,        % 흰색 배경
  colframe=red,         % 빨간색 테두리
  boxrule=1pt,          % 굵은 테두리 선
  arc=2mm,              % 살짝 둥근 모서리
  left=4pt, right=4pt,  % 좌우 여백
  top=4pt, bottom=4pt   % 상하 여백
}

% 강조용 파란 배경 박스
\newtcolorbox{bluebox}{%
  colback=blue!5,       % 아주 연한 파란 배경
  colframe=blue!50,     % 중간 파란 테두리
  boxrule=1pt,        % 테두리 선 두께
  arc=2mm,              % 둥근 모서리 반경
  left=4pt, right=4pt,  % 좌우 여백
  top=4pt, bottom=4pt   % 상하 여백
}

% 글자만 박스로 채우는 grayinline
\newtcbox{\grayinline}{on line,
  colback=gray!10,
  colframe=gray!50,
  boxrule=0.5pt,
  arc=2mm,
  boxsep=1pt,
  left=2pt, right=2pt,
  top=1pt, bottom=1pt,
  box align=base
}

%% sssbox 정의
% 박스 스타일 정의
\NewTColorBox{sssbox}{O{} g}{ % 제목을 안쓰면 그냥 Sss... 출력하고, 제목 쓰면 추가로 붙임
  title={\raisebox{0pt}[9pt][2pt]{\IfNoValueTF{#2}{Sss...}{Sss... \,\, #2}}},
  colback=white,            % 내용 배경색 (본문)
  colframe=black,           % 테두리 색 (검정)
  coltitle=black,           % 제목 글씨색
  colbacktitle=white,       % 제목 배경색 없음 (투명)
  boxrule=1pt,              % 테두리 두께
  arc=1mm,                  % 둥근 모서리
  top=4pt, bottom=4pt,      % 상하 여백
  left=4pt, right=4pt,      % 좌우 여백
  before upper={
  \setlength{\lineskiplimit}{2pt} % 인라인 위아래 간격이 임계값보다 작으면
  \setlength{\lineskip}{5pt} % 추가 간격 확보(수식 입력 등에 유용함)
  \setlength{\abovedisplayskip}{5pt} % 일반적인 디스플레이 수식 여백 설정
  \setlength{\belowdisplayskip}{5pt}
  \setlength{\abovedisplayshortskip}{5pt} % 특수상황(수식 앞줄이 짧게 끝나는 경우)
  \setlength{\belowdisplayshortskip}{5pt}} % 특수상황(수식 아랫줄이 짧게 끝나는 경우)
  #1}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 문제풀이용 박스 제작
%% checkbox 정의
\newcounter{checkbox}[section] % 번호 카운터 정의 (section 기준으로 리셋)
% 번호 형식: chapter.section.checkbox (예: 18.1.1)
\renewcommand{\thecheckbox}{\arabic{chapter}.\arabic{section}.\arabic{checkbox}}
% 박스 스타일 정의
\NewTColorBox{checkboxbox}{O{} g}{ % 제목을 {}안에 넣으면 제목이 함께 출력됨
  title={\raisebox{0pt}[9pt][2pt]{check\thecheckbox\IfNoValueF{#2}{. \,\, #2}}},
  colback=white,            % 내용 배경색
  colframe=gray!50,         % 테두리, 타이틀 배경 색
  coltitle=black,           % 제목 글씨 검정
  boxrule=1pt,              % 테두리 두께
  arc=1mm,                  % 둥근 모서리
  top=4pt, bottom=4pt,      % 상하 여백 줄이기
  left=4pt, right=4pt,      % 좌우 여백
  before upper={
  \setlength{\lineskiplimit}{2pt} % 인라인 위아래 간격이 임계값보다 작으면
  \setlength{\lineskip}{5pt} % 추가 간격 확보(수식 입력 등에 유용함)
  \setlength{\abovedisplayskip}{5pt} % 일반적인 디스플레이 수식 여백 설정
  \setlength{\belowdisplayskip}{5pt}
  \setlength{\abovedisplayshortskip}{5pt} % 특수상황(수식 앞줄이 짧게 끝나는 경우)
  \setlength{\belowdisplayshortskip}{5pt}} % 특수상황(수식 아랫줄이 짧게 끝나는 경우)
  #1}                       % 사용자 정의 옵션 허용
% 환경 정의
\newenvironment{checkbox}
{\refstepcounter{checkbox}\begin{checkboxbox}}{\end{checkboxbox}}

%% checkbox* 정의 - 번호 없음
% 박스 스타일 정의
\NewTColorBox{checkboxbox*}{O{} g}{ % 제목을 {}안에 넣으면 제목이 함께 출력됨
  title={\raisebox{0pt}[9pt][2pt]{check\IfNoValueF{#2}{. \,\, #2}}},
  colback=white,            % 내용 배경색
  colframe=gray!50,         % 테두리, 타이틀 배경 색
  coltitle=black,           % 제목 글씨 검정
  boxrule=1pt,              % 테두리 두께
  arc=1mm,                  % 둥근 모서리
  top=4pt, bottom=4pt,      % 상하 여백 줄이기
  left=4pt, right=4pt,      % 좌우 여백
  before upper={
  \setlength{\lineskiplimit}{2pt} % 인라인 위아래 간격이 임계값보다 작으면
  \setlength{\lineskip}{5pt} % 추가 간격 확보(수식 입력 등에 유용함)
  \setlength{\abovedisplayskip}{5pt} % 일반적인 디스플레이 수식 여백 설정
  \setlength{\belowdisplayskip}{5pt}
  \setlength{\abovedisplayshortskip}{5pt} % 특수상황(수식 앞줄이 짧게 끝나는 경우)
  \setlength{\belowdisplayshortskip}{5pt}} % 특수상황(수식 아랫줄이 짧게 끝나는 경우)
  #1}                       % 사용자 정의 옵션 허용
% 환경 정의
\newenvironment{checkbox*}
{\begin{checkboxbox*}}{\end{checkboxbox*}}

%% practicebox 정의
\newcounter{practicebox}[section]
% 번호 형식
\renewcommand{\thepracticebox}{\arabic{chapter}.\arabic{section}.\arabic{practicebox}}
% 박스 스타일 정의
\NewTColorBox{practiceboxbox}{O{} g}{ % 제목을 {}안에 넣으면 제목이 함께 출력됨
  title={\raisebox{0pt}[9pt][2pt]{practice\thepracticebox\IfNoValueF{#2}{. \,\, #2}}},
  colback=white,            % 내용 배경색
  colframe=black,           % 테두리, 타이틀 배경 색
  coltitle=white,           % 제목 글씨 흰색
  boxrule=1pt,              % 테두리 두께
  arc=1mm,                  % 둥근 모서리
  top=4pt, bottom=4pt,      % 상하 여백 줄이기
  left=4pt, right=4pt,      % 좌우 여백
  before upper={
  \setlength{\lineskiplimit}{2pt} % 인라인 위아래 간격이 임계값보다 작으면
  \setlength{\lineskip}{5pt} % 추가 간격 확보(수식 입력 등에 유용함)
  \setlength{\abovedisplayskip}{5pt} % 일반적인 디스플레이 수식 여백 설정
  \setlength{\belowdisplayskip}{5pt}
  \setlength{\abovedisplayshortskip}{5pt} % 특수상황(수식 앞줄이 짧게 끝나는 경우)
  \setlength{\belowdisplayshortskip}{5pt}} % 특수상황(수식 아랫줄이 짧게 끝나는 경우)
  #1}                       % 사용자 정의 옵션 허용
% 환경 정의
\newenvironment{practicebox}
{\refstepcounter{practicebox}\begin{practiceboxbox}}{\end{practiceboxbox}}

%% practicebox* 정의 - 번호 없음
% 박스 스타일 정의
\NewTColorBox{practiceboxbox*}{O{} g}{ % 제목을 {}안에 넣으면 제목이 함께 출력됨
  title={\raisebox{0pt}[9pt][2pt]{practice\IfNoValueF{#2}{. \,\, #2}}},
  colback=white,            % 내용 배경색
  colframe=black,           % 테두리, 타이틀 배경 색
  coltitle=white,           % 제목 글씨 흰색
  boxrule=1pt,              % 테두리 두께
  arc=1mm,                  % 둥근 모서리
  top=4pt, bottom=4pt,      % 상하 여백 줄이기
  left=4pt, right=4pt,      % 좌우 여백
  before upper={
  \setlength{\lineskiplimit}{2pt} % 인라인 위아래 간격이 임계값보다 작으면
  \setlength{\lineskip}{5pt} % 추가 간격 확보(수식 입력 등에 유용함)
  \setlength{\abovedisplayskip}{5pt} % 일반적인 디스플레이 수식 여백 설정
  \setlength{\belowdisplayskip}{5pt}
  \setlength{\abovedisplayshortskip}{5pt} % 특수상황(수식 앞줄이 짧게 끝나는 경우)
  \setlength{\belowdisplayshortskip}{5pt}} % 특수상황(수식 아랫줄이 짧게 끝나는 경우)
  #1}                       % 사용자 정의 옵션 허용
% 환경 정의
\newenvironment{practicebox*}
{\begin{practiceboxbox*}}{\end{practiceboxbox*}}













%% problem 정의 - 번호 없음, 수기로 작성
% 번호 형식
% 박스 스타일 정의
\NewTColorBox{problemboxbox}{O{} g}{ % 제목을 {}안에 넣으면 제목이 함께 출력됨
  title={\raisebox{0pt}[9pt][2pt]{problem\IfNoValueF{#2}{. \,\, #2}}},
  colback=white,            % 내용 배경색
  colframe=black,           % 테두리, 타이틀 배경 색
  coltitle=white,           % 제목 글씨 흰색
  boxrule=1pt,              % 테두리 두께
  arc=1mm,                  % 둥근 모서리
  top=4pt, bottom=4pt,      % 상하 여백 줄이기
  left=4pt, right=4pt,      % 좌우 여백
  before upper={
  \setlength{\lineskiplimit}{2pt} % 인라인 위아래 간격이 임계값보다 작으면
  \setlength{\lineskip}{5pt} % 추가 간격 확보(수식 입력 등에 유용함)
  \setlength{\abovedisplayskip}{5pt} % 일반적인 디스플레이 수식 여백 설정
  \setlength{\belowdisplayskip}{5pt}
  \setlength{\abovedisplayshortskip}{5pt} % 특수상황(수식 앞줄이 짧게 끝나는 경우)
  \setlength{\belowdisplayshortskip}{5pt}} % 특수상황(수식 아랫줄이 짧게 끝나는 경우)
  #1}                       % 사용자 정의 옵션 허용
% 환경 정의
\newenvironment{problembox}
{\begin{problemboxbox}}{\end{problemboxbox}}

% 문제번호 저장용 매크로
\newcommand{\ProblemNumberumber}{0} % 초기값 0으로 설정
\newcommand{\ProblemNumber}[1]{\renewcommand{\ProblemNumberumber}{\unskip#1\unskip}} % 공백 무시, pn값을 저장